name: test123
on:
  push:
    branches:
      - master

jobs:
  test123:
    runs-on: ubuntu-latest
    steps:
      - name: "run shell"
        shell: bash
        run: |
          git clone --depth 1 https://github.com/spack/spack
          cd spack
          . share/spack/setup-env.sh
          spack mirror add spack-build-cache oci://ghcr.io/${{ github.repository_owner }}/spack-build-cache
          spack mirror set --oci-username ${{ github.repository_owner }} --oci-password "${{ secrets.GITHUB_TOKEN }}" spack-build-cache
          spack install gmake
          spack buildcache push spack-build-cache gmake
